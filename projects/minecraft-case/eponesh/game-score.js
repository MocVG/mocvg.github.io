/*! For license information please see game-score.js.LICENSE.txt */
(()=>{var e,t,n,i,r={2616:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(r[o]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);i&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},5585:e=>{!function(t){e.exports=t;var n={on:function(e,t){return s(this,e).push(t),this},once:function(e,t){var n=this;return i.originalListener=t,s(n,e).push(i),n;function i(){r.call(n,e,i),t.apply(this,arguments)}},off:r,emit:function(e,t){var n=this,i=s(n,e,!0);if(!i)return!1;var r=arguments.length;if(1===r)i.forEach(a);else if(2===r)i.forEach(c);else{var o=Array.prototype.slice.call(arguments,1);i.forEach(l)}return!!i.length;function a(e){e.call(n)}function c(e){e.call(n,t)}function l(e){e.apply(n,o)}}};function i(e){for(var t in n)e[t]=n[t];return e}function r(e,t){var n,i=this;if(arguments.length){if(t){if(n=s(i,e,!0)){if(!(n=n.filter(o)).length)return r.call(i,e);i.listeners[e]=n}}else if((n=i.listeners)&&(delete n[e],!Object.keys(n).length))return r.call(i)}else delete i.listeners;return i;function o(e){return e!==t&&e.originalListener!==t}}function s(e,t,n){if(!n||e.listeners){var i=e.listeners||(e.listeners={});return i[t]||(i[t]=[])}}i(t.prototype),t.mixin=i}((function e(){if(!(this instanceof e))return new e}))},4943:e=>{"use strict";e.exports=i,e.exports.isMobile=i,e.exports.default=i;var t=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/android|ipad|playbook|silk/i;function i(e){e||(e={});var i=e.ua;if(i||"undefined"==typeof navigator||(i=navigator.userAgent),i&&i.headers&&"string"==typeof i.headers["user-agent"]&&(i=i.headers["user-agent"]),"string"!=typeof i)return!1;var r=t.test(i)||!!e.tablet&&n.test(i);return!r&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==i.indexOf("Macintosh")&&-1!==i.indexOf("Safari")&&(r=!0),r}},2096:()=>{"function"!=typeof Promise.prototype.finally&&(Promise.prototype.finally=function(e){var t=this;return this.then((function(n){return t.constructor.resolve(e()).then((function(){return n}))})).catch((function(n){return t.constructor.resolve(e()).then((function(){throw n}))}))})},8205:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(2616),r=n.n(i)()((function(e){return e[1]}));r.push([e.id,".gs-global-loader{position:fixed;z-index:99999;top:8px;right:8px;width:48px;height:48px}@media only screen and (min-width: 1024px){.gs-global-loader{top:inherit;right:16px;bottom:16px}}.gs-loader{position:relative;width:40px;height:40px;border-radius:50%;display:flex}.gs-loader__outter{box-sizing:border-box;position:absolute;border:4px solid #f50057;border-left-color:transparent;width:100%;height:100%;border-radius:50%;-webkit-animation:loader-outter 1s cubic-bezier(0.42, 0.61, 0.58, 0.41) infinite;animation:loader-outter 1s cubic-bezier(0.42, 0.61, 0.58, 0.41) infinite}.gs-loader__inner{box-sizing:border-box;position:absolute;border:4px solid #f50057;border-radius:50%;width:20px;height:20px;left:calc(50% - 10px);top:calc(50% - 10px);border-top-color:transparent;-webkit-animation:loader-inner 1s cubic-bezier(0.42, 0.61, 0.58, 0.41) infinite;animation:loader-inner 1s cubic-bezier(0.42, 0.61, 0.58, 0.41) infinite}@keyframes loader-outter{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes loader-inner{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(-360deg);transform:rotate(-360deg)}}",""]);const s=r},3379:(e,t,n)=>{"use strict";var i,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function o(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function a(e,t){for(var n={},i=[],r=0;r<e.length;r++){var a=e[r],c=t.base?a[0]+t.base:a[0],l=n[c]||0,h="".concat(c," ").concat(l);n[c]=l+1;var d=o(h),u={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(s[d].references++,s[d].updater(u)):s.push({identifier:h,updater:v(u,t),references:1}),i.push(h)}return i}function c(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=n.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=r(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,h=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function d(e,t,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=h(t,r);else{var s=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(s,o[t]):e.appendChild(s)}}function u(e,t,n){var i=n.css,r=n.media,s=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var f=null,p=0;function v(e,t){var n,i,r;if(t.singleton){var s=p++;n=f||(f=c(t)),i=d.bind(null,n,s,!1),r=d.bind(null,n,s,!0)}else n=c(t),i=u.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=a(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var r=o(n[i]);s[r].references--}for(var c=a(e,t),l=0;l<n.length;l++){var h=o(n[l]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}n=c}}}},4687:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i,r,s,o=n(6558),a=n(8293),c=n(6388),l=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},h=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class d extends c.Z{constructor(e,t){super(),this.gs=e,this.adapter=t,i.set(this,[]),r.set(this,{}),s.set(this,{})}get isAvailable(){return this.adapter.isSupportsPayments}get purchases(){return[...h(this,i,"f")]}_sync(){return l(this,void 0,void 0,(function*(){const{purchases:e,payload:t}=yield this.adapter.fetchPurchases();if(0===e.length)return;const{playerPurchases:n}=yield this.gs._paymentsService.sync({purchases:e,payload:t});this._setPurchasedList(n)}))}fetchProducts(){return l(this,void 0,void 0,(function*(){const e=(0,a._)();this.gs.loader.inc();try{const t=yield this.gs._paymentsService.fetch();if(!t)throw new Error("can't fetch products list");const{products:n,playerPurchases:i}=t,r=yield this.adapter.mapProducts(this.gs,{products:n,playerPurchases:i});e.done(r),this._events.emit("fetchProducts",r)}catch(t){e.abort(t),this._events.emit("error:fetchProducts",t)}finally{this.gs.loader.dec()}return e.ready}))}purchase({id:e,tag:t}){return l(this,void 0,void 0,(function*(){const n=e||t;if(h(this,r,"f")[n])return h(this,r,"f")[n];const s=(0,a._)();h(this,r,"f")[n]=s,this.gs.loader.inc();try{const{product:n}=yield this.gs._paymentsService.findProduct({id:e,tag:t});if(!n)throw new Error(`Not found product with ID or TAG "${e||t}"`);let r,a,c=!0,l="";this.gs.player.isLoggedInByPlatform||(yield this.gs.player.sync({silent:!1}));try{a=yield this.adapter.purchase(n)}catch(e){throw e}if(this.adapter.isServerValidation)r={productId:n.id,payload:a,createdAt:this.gs.serverTime,gift:!1};else try{r=(yield this.gs._paymentsService.purchase({id:e,tag:t,payload:a})).purchase}catch(e){c=!1,l=e.message}c?(h(this,i,"f").push({id:n.id,tag:n.tag,createdAt:r.createdAt}),this._events.emit("purchase",{product:n,purchase:r})):o.kg.error(l),s.done({success:c,product:n,purchase:r,error:l})}catch(e){s.abort(e),this._events.emit("error:purchase",e)}finally{this.gs.loader.dec()}return s.ready.finally((()=>{delete h(this,r,"f")[n]})),s.ready}))}consume({id:e,tag:t}){return l(this,void 0,void 0,(function*(){const n=e||t;if(h(this,s,"f")[n])return h(this,s,"f")[n];const r=(0,a._)();h(this,s,"f")[n]=r,this.gs.loader.inc();try{const{product:n,purchase:s}=yield this.gs._paymentsService.consume({id:e,tag:t});s.gift||(yield this.adapter.consume(s));const o=h(this,i,"f").findIndex((e=>e.id===n.id));-1!==o&&h(this,i,"f").splice(o,1),this._events.emit("consume",{product:n,purchase:s}),r.done({product:n,purchase:s,success:!0,error:""})}catch(e){r.abort(e),this._events.emit("error:consume",e)}finally{this.gs.loader.dec()}return r.ready.finally((()=>{delete h(this,s,"f")[n]})),r.ready}))}has(e){return h(this,i,"f").some((t=>t.tag===e||t.id===e))}getPurchase(e){return h(this,i,"f").find((t=>t.tag===e||t.id===e))||null}_setPurchasedList(e){!function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,i,[...e],"f")}}i=new WeakMap,r=new WeakMap,s=new WeakMap},4293:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(8293);const r=["adsbox","advertisement","pub_300x250","pub_300x250m","pub_728x90","text-ad","textAd","text_ad","text_ads","text-ads","text-ad-links"];var s=n(9233),o=n(6388),a=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class c extends o.Z{constructor(e,t,n){super(),this.gs=e,this.adapter=t,this.platformConfig=n,this.isAdblockEnabled=!1,this.fullscreenDisplayIntervalId=0,this.stickyRefreshIntervalId=0,this.isStickyPlaying=!1,this.isRewardedPlaying=!1,this.isFullscreenPlaying=!1,this.isPreloaderPlaying=!1,this.adsInfo=e._storage.temp.adsInfo;const i=this.platformConfig.banners;this.stickyBanner=i.find((e=>e.type===s.$.STICKY)),this.fullscreenBanner=i.find((e=>e.type===s.$.FULLSCREEN)),this.rewardedVideo=i.find((e=>e.type===s.$.REWARDED)),this.preloaderBanner=i.find((e=>e.type===s.$.PRELOADER)),this.banners=i.reduce(((e,t)=>(e[t.type]=t,e)),{}),this._checkLimitsExpired(!0),setInterval((()=>this._checkLimitsExpired(!1)),1e3)}get isStickyAvailable(){var e;return this.adapter.isStickyAvailable&&(null===(e=this.stickyBanner)||void 0===e?void 0:e.enabled)&&!this.isBannerLimitReached(s.$.STICKY)}get isFullscreenAvailable(){var e;return this.adapter.isFullscreenAvailable&&(null===(e=this.fullscreenBanner)||void 0===e?void 0:e.enabled)&&!this.fullscreenDisplayIntervalId&&!this.isBannerLimitReached(s.$.FULLSCREEN)}get isRewardedAvailable(){var e;return this.adapter.isRewardedAvailable&&(null===(e=this.rewardedVideo)||void 0===e?void 0:e.enabled)&&!this.isBannerLimitReached(s.$.REWARDED)}get isPreloaderAvailable(){var e;return this.adapter.isPreloaderAvailable&&(null===(e=this.preloaderBanner)||void 0===e?void 0:e.enabled)&&!this.isBannerLimitReached(s.$.PRELOADER)}checkAdblock(){return a(this,void 0,void 0,(function*(){return this.isAdblockEnabled=yield function(){const e=(0,i._)(),t=document.createElement("div");return t.innerHTML="&nbsp;",t.className=r.join(" "),t.id="text_ad",t.style.padding="1px 0 0 0",document.body.appendChild(t),setTimeout((()=>{e.done(0===t.offsetHeight),document.body.removeChild(t)}),10),e.ready}(),this.isAdblockEnabled}))}showFullscreen(){return a(this,void 0,void 0,(function*(){if(!this.isFullscreenAvailable)return this._events.emit("close",!1),this._events.emit("fullscreen:close",!1),!1;this.fullscreenBanner.frequency,this._events.emit("start"),this._events.emit("fullscreen:start"),this.fullscreenDisplayIntervalId=window.setTimeout((()=>{this.fullscreenDisplayIntervalId=0}),1e3*this.fullscreenBanner.frequency),this.isFullscreenPlaying=!0;const e=yield this.adapter.showFullscreen(this.fullscreenBanner);return this.isFullscreenPlaying=!1,this._events.emit("close",e),this._events.emit("fullscreen:close",e),e&&this._trackBannerDisplay(s.$.FULLSCREEN),e}))}showRewardedVideo(){return a(this,void 0,void 0,(function*(){if(!this.isRewardedAvailable)return this._events.emit("close",!1),this._events.emit("rewarded:close",!1),!1;this._events.emit("start"),this._events.emit("rewarded:start"),this.isRewardedPlaying=!0;const e=yield this.adapter.showRewardedVideo(this.rewardedVideo);return this.isRewardedPlaying=!1,this._events.emit("close",e),this._events.emit("rewarded:close",e),this._trackBannerDisplay(s.$.REWARDED),e&&this._events.emit("rewarded:reward"),e}))}showPreloader(){return a(this,void 0,void 0,(function*(){if(!this.isPreloaderAvailable)return this._events.emit("close",!1),this._events.emit("preloader:close",!1),!1;this._events.emit("start"),this._events.emit("preloader:start"),this.isPreloaderPlaying=!0;const e=yield this.adapter.showPreloader(this.preloaderBanner);return this.isPreloaderPlaying=!1,this._events.emit("close",e),this._events.emit("preloader:close",e),e&&this._trackBannerDisplay(s.$.PRELOADER),e}))}showSticky(){return a(this,void 0,void 0,(function*(){if(!this.isStickyAvailable)return this._events.emit("close",!1),this._events.emit("sticky:close",!1),!1;!this.stickyRefreshIntervalId&&this.stickyBanner.refreshInterval&&(this.stickyRefreshIntervalId=window.setInterval((()=>this.refreshSticky()),1e3*this.stickyBanner.refreshInterval)),this._events.emit("start"),this._events.emit("sticky:start");const e=yield this.adapter.showSticky(this.stickyBanner);return this.isStickyPlaying=e,this._events.emit("sticky:render",e),e&&this._trackBannerDisplay(s.$.STICKY),e}))}refreshSticky(){return a(this,void 0,void 0,(function*(){if(!this.isStickyAvailable)return this._events.emit("close",!1),this._events.emit("sticky:close",!1),!1;clearInterval(this.stickyRefreshIntervalId),this.stickyBanner.refreshInterval&&(this.stickyRefreshIntervalId=window.setInterval((()=>this.refreshSticky()),1e3*this.stickyBanner.refreshInterval)),this._events.emit("sticky:refresh");const e=yield this.adapter.refreshSticky(this.stickyBanner);return this.isStickyPlaying=e,this._events.emit("sticky:render",e),e&&this._trackBannerDisplay(s.$.STICKY),e}))}closeSticky(){return a(this,void 0,void 0,(function*(){const e=yield this.adapter.closeSticky();return this.isStickyPlaying=!1,this._events.emit("close",!0),this._events.emit("sticky:close",!0),clearInterval(this.stickyRefreshIntervalId),e}))}_trackBannerDisplay(e){const t=this.adsInfo.limits[e];t.hour.count+=1,t.day.count+=1,t.session.count+=1,t.day.timestamp||(t.day.timestamp=Date.now()),t.hour.timestamp||(t.hour.timestamp=Date.now()),this._saveAdsInfo()}_checkLimitsExpired(e){let t=!1;Object.values(this.adsInfo.limits).forEach((n=>{e&&(n.session.count=0),l(n.hour.timestamp,36e5)&&(n.hour.timestamp=0,n.hour.count=0,t=!0),l(n.day.timestamp,864e5)&&(n.day.timestamp=0,n.hour.count=0,t=!0)})),t&&this._saveAdsInfo()}_saveAdsInfo(){this.gs._storage.saveAdsInfo(this.adsInfo)}isBannerLimitReached(e){return this.isBannerLimitTypeReached(e,"hour")||this.isBannerLimitTypeReached(e,"day")||this.isBannerLimitTypeReached(e,"session")}isBannerLimitTypeReached(e,t){const n=this.banners[e].limits[t];return!!n&&this.adsInfo.limits[e][t].count>=n}}function l(e,t){return(new Date).getTime()-new Date(e).getTime()>t}},6388:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(5585),r=n.n(i);class s{constructor(){this._events=new(r())}on(e,t){this._events.on(e,t)}off(e,t){this._events.off(e,t)}once(e,t){this._events.once(e,t)}}},1049:(e,t,n)=>{"use strict";function i(e,t,n){return e.replace(/{{hash}}/gi,t).replace(/{{size}}/gi,n)}n.d(t,{Z:()=>i})},4917:(e,t,n)=>{"use strict";function i({src:e,check:t}){return new Promise(((n,i)=>{let r=0;if(null==t?void 0:t(window))return void n();function s(){t?t(window)&&(clearInterval(r),n()):n()}var o=document.getElementsByTagName("script")[0];const a=document.createElement("script");a.src=e,a.onload=s,a.onerror=i,o.parentNode.insertBefore(a,o),t&&(r=setInterval(s,100))}))}n.d(t,{Z:()=>i})},6558:(e,t,n)=>{"use strict";n.d(t,{Yd:()=>s,kg:()=>o,EK:()=>a});var i,r=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class s{constructor(){i.set(this,"[GameScore]: "),this.isCollectingLogs=!0,this.logs=[],this.log=(...e)=>{this.collectLogs("log",e),console.log(r(this,i,"f"),...e)},this.info=(...e)=>{this.collectLogs("info",e),console.info(r(this,i,"f"),...e)},this.warn=(...e)=>{this.collectLogs("warn",e),console.warn(r(this,i,"f"),...e)},this.error=(...e)=>{this.collectLogs("error",e),console.error(r(this,i,"f"),...e)}}stopCollect(){this.isCollectingLogs=!1,this.logs=[]}collectLogs(e,t){this.isCollectingLogs&&this.logs.push({type:e,args:t})}}i=new WeakMap;let o=new s;const a=e=>o=e},4835:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={app:{trophy:"eponesh/static/trophy.svg"},cdn:{trophy:"eponesh/static/reward.png"}}},8293:(e,t,n)=>{"use strict";n.d(t,{s:()=>r,_:()=>s});var i=n(6558);const r={timeout:5e3};function s({timeout:e=0}={}){let t=!1;const n={},r=new Promise(((e,r)=>{n.done=n=>{t||(t=!0,e(n))},n.abort=e=>{t||(t=!0,i.kg.error(e),r(e))}}));return e&&setTimeout((()=>{t||n.abort(`Timeout ${e}ms exceeded`)}),e),n.ready=r,n}},9991:(e,t,n)=>{"use strict";function i(e){return new Promise((t=>{let n=0;e(window)?t():n=setInterval((function(){e(window)&&(clearInterval(n),t())}),100)}))}n.d(t,{Z:()=>i})},5942:(e,t,n)=>{"use strict";var i;n.d(t,{z:()=>i}),function(e){e.YANDEX="YANDEX",e.VK="VK",e.OK="OK",e.GAME_MONETIZE="GAME_MONETIZE",e.GAME_DISTRIBUTION="GAME_DISTRIBUTION",e.CRAZY_GAMES="CRAZY_GAMES",e.SMARTMARKET="SMARTMARKET",e.GAMEPIX="GAMEPIX",e.NONE="NONE"}(i||(i={}))},584:(e,t,n)=>{"use strict";n.d(t,{P8:()=>c,ZP:()=>l});var i,r=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const s="{\n    id\n    iconSmall: icon(w: 48, h: 48, crop: false)\n    icon(w: 256, h: 256, crop: false)\n    tag\n    rare\n    name(lang: $lang)\n    description(lang: $lang)\n}",o=`mutation ($input: UnlockPlayerAchievementInput!, $lang: Lang) {\n    result: UnlockPlayerAchievement(input: $input) {\n        __typename\n        ... on Problem { message }\n        ... on Achievement ${s}\n    }\n}`,a=`query($lang: Lang) {\n    result: FetchPlayerAchievements {\n        __typename\n        ... on Problem { message }\n        ... on PlayerAchievements {\n            achievements ${s}\n            achievementsGroups { id tag name(lang: $lang) description(lang: $lang) achievements }\n            playerAchievements { playerId achievementId createdAt }\n        }\n    }\n}`;var c;!function(e){e.COMMON="COMMON",e.UNCOMMON="UNCOMMON",e.RARE="RARE",e.EPIC="EPIC",e.LEGENDARY="LEGENDARY",e.MYTHIC="MYTHIC"}(c||(c={}));class l{constructor(e){i.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,i,e,"f")}fetch(){return r(this,i,"f").fetch(a)}unlock({id:e,tag:t}){return r(this,i,"f").fetch(o,{id:e,tag:t})}}i=new WeakMap},9233:(e,t,n)=>{"use strict";var i;n.d(t,{$:()=>i,iA:()=>r}),function(e){e.PRELOADER="PRELOADER",e.FULLSCREEN="FULLSCREEN",e.REWARDED="REWARDED",e.STICKY="STICKY"}(i||(i={}));const r={appId:"",community:"",communityLink:"",gameLink:"",banners:[]};new WeakMap},7802:(e,t,n)=>{"use strict";n.d(t,{S:()=>o,Z:()=>p});var i,r=n(4692),s=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const o="\n    name(lang: $lang)\n    key\n    type\n    default\n    important\n    variants {\n        value\n        name(lang: $lang)\n    }\n",a="\n    state\n    achievements { id tag createdAt }\n    purchases { id tag createdAt }\n",c=`\n... on Player {\n    ${a}\n}\n... on Problem { message }\n`,l=`mutation ($input: SyncPlayerInput!, $lang: Lang) {\n    result: SyncPlayer(input: $input) {\n        __typename\n        ${c}\n        ... on PlayerSyncConflict {\n            players\n            fields { ${o} }\n        }\n    }\n}`,h=`query {\n    result: GetPlayer {\n        __typename\n        ${c}\n    }\n}`,d=`query ($lang: Lang) {\n    result: FetchPlayerFields {\n        __typename\n        ... on Problem { message }\n        ... on ModelFieldsList {\n            items { ${o} }\n        }\n    }\n}`,u=`\n    ... on FullPlayersList {\n        players { ${a} }\n    }\n`,f=`query($input: PlayerFetchPlayersInput!) {\n    result: PlayerFetchPlayers(input: $input) { ${(0,r.M)(u)} }\n}`;class p{constructor(e){i.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,i,e,"f")}sync({playerState:e,override:t}){return s(this,i,"f").fetch(l,{playerState:e,override:t})}getPlayer(){return s(this,i,"f").fetch(h)}fetchFields(){return e=this,t=void 0,r=function*(){return s(this,i,"f").fetch(d)},new((n=void 0)||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r}checkCode({secretCode:e}){return s(this,i,"f").fetch("query ($input: CheckPlayerCodeInput!) {\n    result: CheckPlayerCode(input: $input) {\n        __typename\n        ... on Problem { message }\n        ... on Success { success }\n    }\n}",{secretCode:e})}fetchPlayers({ids:e}){return s(this,i,"f").fetch(f,{ids:e})}}i=new WeakMap},3204:(e,t,n)=>{"use strict";n.d(t,{Uo:()=>h,lR:()=>d,GH:()=>u,ZP:()=>f});var i,r=n(9233),s=n(7802),o=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const a="\n    key\n    value(lang: $lang)\n    type\n",c=`query ($lang: Lang) {\n    result: FetchPlayerProjectConfig {\n        __typename\n        ... on Problem { message }\n        ... on PlayerProjectConfig {\n            isDev\n            isAllowedOrigin\n            config {\n                lang\n                avatarGenerator\n                avatarGeneratorTemplate\n                ymCounterId\n                gtagCounterId\n            }\n            platformConfig {\n                appId\n                gameLink\n                community\n                communityLink\n                banners {\n                    type\n                    enabled\n                    bannerId\n                    desktopBannerId\n                    frequency\n                    refreshInterval\n                    maxWidth\n                    maxHeight\n                    maxWidthDimension\n                    maxHeightDimension\n                    desktopMaxWidth\n                    desktopMaxHeight\n                    desktopMaxWidthDimension\n                    desktopMaxHeightDimension\n                    fitCanvas\n                    position\n                    limits { hour day session }\n                    useNative\n                }\n            }\n            playerFields { ${s.S} }\n            serverTime\n            gameVariables { ${a} }\n            acl {\n                canUploadImages\n                canUploadFiles\n            }\n        }\n    }\n}`,l=`query ($lang: Lang) {\n    result: FetchPlayerProjectVariables {\n        __typename\n        ... on Problem { message }\n        ... on ProjectVariablesList {\n            items { ${a} }\n        }\n    }\n}`;var h;!function(e){e.EN="en",e.FR="fr",e.IT="it",e.DE="de",e.ES="es",e.ZH="zh",e.PT="pt",e.KO="ko",e.JA="ja",e.RU="ru",e.TR="tr"}(h||(h={}));const d={isDev:!1,isAllowedOrigin:!0,config:{lang:h.EN,avatarGenerator:"dicebear_retro",avatarGeneratorTemplate:""},platformConfig:r.iA,playerFields:[],serverTime:(new Date).toISOString(),gameVariables:[],acl:{canUploadFiles:!1,canUploadImages:!1}},u={limits:{[r.$.PRELOADER]:{hour:{timestamp:0,count:0},day:{timestamp:0,count:0},session:{count:0}},[r.$.FULLSCREEN]:{hour:{timestamp:0,count:0},day:{timestamp:0,count:0},session:{count:0}},[r.$.REWARDED]:{hour:{timestamp:0,count:0},day:{timestamp:0,count:0},session:{count:0}},[r.$.STICKY]:{hour:{timestamp:0,count:0},day:{timestamp:0,count:0},session:{count:0}}}};class f{constructor(e){i.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,i,e,"f")}fetchConfig(){return o(this,i,"f").fetch(c)}fetchVariables(){return o(this,i,"f").fetch(l)}}i=new WeakMap},4692:(e,t,n)=>{"use strict";n.d(t,{M:()=>i,t:()=>r});const i=e=>`\n    __typename\n    ... on Problem { message }\n    ${e}\n`,r=e=>{if("Problem"===(null==e?void 0:e.__typename))throw e.message}}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={id:e,exports:{}};return r[e].call(n.exports,n,n.exports,o),n.exports}o.m=r,o.amdO={},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var r=Object.create(null);o.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,o.d(r,s),r},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>(({47:"i18n/pt-json",66:"i18n/tr-json",159:"i18n/it-json",263:"game-score.overlay",369:"platforms/platform.gm",433:"platforms/platform.cg",459:"i18n/de-json",477:"platforms/platform.gp",552:"platforms/platform.smartmarket",600:"game-score.devtools",606:"i18n/devtools-ru-json",614:"platforms/platform.ok",670:"i18n/ko-json",746:"i18n/fr-json",755:"platforms/platform.yandex",766:"platforms/platform.gs",848:"i18n/ja-json",851:"platforms/platform.vk.app",860:"platforms/platform.gd",897:"i18n/devtools-en-json",911:"platforms/platform.vk",929:"i18n/zh-json",932:"i18n/en-json",964:"i18n/ru-json",968:"i18n/es-json"}[e]||e)+"."+o.h()+".js"),o.h=()=>"e132ced82641f20ff2b2",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},i="game-score-sdk:",o.l=(e,t,r,s)=>{if(n[e])n[e].push(t);else{var a,c;if(void 0!==r)for(var l=document.getElementsByTagName("script"),h=0;h<l.length;h++){var d=l[h];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+r){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",i+r),a.src=e,0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous")),n[e]=[t];var u=(t,i)=>{a.onerror=a.onload=null,clearTimeout(f);var r=n[e];if(delete n[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(i))),t)return t(i)},f=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),c&&document.head.appendChild(a)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={742:0};o.f.j=(t,n)=>{var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=e[t]=[n,r]));n.push(i[2]=r);var s=o.p+o.u(t),a=new Error;o.l(s,(n=>{if(o.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,r,[s,a,c]=n,l=0;for(i in a)o.o(a,i)&&(o.m[i]=a[i]);for(c&&c(o),t&&t(n);l<s.length;l++)r=s[l],o.o(e,r)&&e[r]&&e[r][0](),e[s[l]]=0},n=self.webpackChunkgame_score_sdk=self.webpackChunkgame_score_sdk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";o(2096);var e=o(4943),t=o.n(e),n=o(4293),i=o(5942);var r=o(8293),s=o(7802);class a{constructor(e,t){this.config=e,this.adapter=t}get hasIntegratedAuth(){return this.adapter.hasIntegratedAuth}get isSecretCodeAuthAvailable(){return this.adapter.isSecretCodeAuthAvailable}get _hasAuthModal(){return this.adapter._hasAuthModal}get isExternalLinksAllowed(){return this.adapter.isExternalLinksAllowed}get type(){return this.adapter.type}get availableSocialNetworks(){return this.adapter.socialNetworks}getSDK(){return this.adapter.getSDK()}getNativeSDK(){return this.adapter.getNativeSDK()}requestPermissions(e){return t=this,n=void 0,r=function*(){return this.adapter.requestPermissions(e)},new((i=void 0)||(i=Promise))((function(e,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}c((r=r.apply(t,n||[])).next())}));var t,n,i,r}}var c=o(3379),l=o.n(c),h=o(8205);l()(h.Z,{insert:"head",singleton:!1}),h.Z.locals;var d,u=o(6558),f=o(3204),p=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},v=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},g=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class y{constructor(e=[]){this.storages=e,d.set(this,""),this.isEmptyOnBoot=!0,this.temp={};const t=(0,r._)();this.ready=t.ready,Promise.all([this._get("context"),this._get("config")]).then((([e,n])=>{v(this,d,e||"","f"),this.isEmptyOnBoot=!n,t.done()}))}_get(e){const t=(0,r._)();return Promise.all(this.storages.map((t=>{const n=(0,r._)(r.s);return t.get(e).then(n.done).catch(n.abort),n.ready.catch((e=>(u.kg.warn(e),null)))}))).then((e=>t.done(e.find(Boolean)))),t.ready}_set(e,t){return Promise.all(this.storages.map((n=>n.set(e,t))))}set(e,t){return this._set(`${e}${g(this,d,"f")}`,t)}get(e){return this._get(`${e}${g(this,d,"f")}`)}isEmptyContext(){return!g(this,d,"f")}setContext(e){v(this,d,e,"f"),this._set("context",g(this,d,"f"))}migrateToContext(e){return p(this,void 0,void 0,(function*(){v(this,d,"","f");const[t,n,i]=yield Promise.all([this.loadPlayer(),this.loadSecretCode(),this.loadLanguage()]),r=n||(null==t?void 0:t.secretCode);return v(this,d,e,"f"),yield Promise.all([this.savePlayer(t),this.saveSecretCode(r),this.saveLanguage(i)]),v(this,d,"","f"),yield Promise.all([this.savePlayer(null),this.saveSecretCode(null),this.saveLanguage(null)]),[t,r]}))}clearContext(e){return p(this,void 0,void 0,(function*(){const t=g(this,d,"f");v(this,d,e,"f"),yield Promise.all([this.savePlayer(null),this.saveSecretCode(null),this.saveLanguage(null)]),v(this,d,t,"f")}))}extractFromContext(e){return p(this,void 0,void 0,(function*(){const t=g(this,d,"f");v(this,d,e,"f");const[n,i,r]=yield Promise.all([this.loadPlayer(),this.loadSecretCode(),this.loadLanguage()]),s=i||(null==n?void 0:n.secretCode);return v(this,d,t,"f"),[n,s,r]}))}copyFromContext(e,t){return p(this,void 0,void 0,(function*(){const n=g(this,d,"f"),[i,r,s]=yield this.extractFromContext(e);v(this,d,t,"f"),yield Promise.all([this.savePlayer(i),this.saveSecretCode(r),this.saveLanguage(s)]),v(this,d,n,"f")}))}loadPlayer(){return this.get("players").then((([e]=[null])=>e))}savePlayer(e){return this.set("players",[e]).catch(u.kg.warn)}loadSecretCode(){return this.get("sk").catch(u.kg.warn)}saveSecretCode(e){return this.set("sk",e).catch(u.kg.warn)}loadLanguage(){return this.get("lang").catch((e=>(u.kg.warn(e),null)))}saveLanguage(e){return this.set("lang",e).catch(u.kg.warn)}loadConfig(){return this._get("config").then((e=>Object.assign(Object.assign({},f.lR),e))).catch((e=>(u.kg.warn(e),f.lR)))}saveConfig(e){return this._set("config",e).catch(u.kg.warn)}loadAdsInfo(){const e=this._get("adsInfo").then((e=>Object.assign(Object.assign({},f.GH),e))).catch((e=>(u.kg.warn(e),f.GH)));return e.then((e=>this.temp.adsInfo=e)),e}saveAdsInfo(e){return this._set("adsInfo",e).catch(u.kg.warn)}saveIsExistsShortcut(e){this.set("isExistsShortcut",e)}loadIsExistsShortcut(){return this.get("isExistsShortcut")}}d=new WeakMap;var m=o(6388),w=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class b extends Error{constructor(){super("throttled invocation was canceled"),this.name="CanceledError"}}class _{constructor(e,t){this.canceled=!1;const n=new Promise((e=>{this.timeout=setTimeout(e,t),this.resolve=e}));this.ready=e.then((()=>n),(()=>n))}flush(){clearTimeout(this.timeout),this.resolve()}cancel(){this.canceled=!0,clearTimeout(this.timeout),this.resolve()}then(e){return this.ready.then((()=>{if(this.canceled)throw new b;return e()}))}}function P(e,t,n={}){const i=null!=t&&Number.isFinite(t)?Math.max(t,0):0,r=n.getNextArgs||((e,t)=>t);let s,o=Promise.resolve(),a=new _(o,0),c=null;function l(){const t=s;c=null,s=null;const n=(()=>w(this,void 0,void 0,(function*(){return yield e.apply(this,t)})))();return a=new _(n,i),n}function h(...e){return s=s?r(s,e):e,c||(c=a.then(l.bind(this))),c}return h.cancel=()=>w(this,void 0,void 0,(function*(){const e=o;a.cancel(),c=null,s=null,o=Promise.resolve(),a=new _(o,0),yield e})),h.flush=()=>w(this,void 0,void 0,(function*(){a.flush(),yield o})),h}function E(e){return function(t,n,i){const r=i.value;return i.value=P(r,e),i}}P.CanceledError=b;var k=o(4692),S=function(e,t,n,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},C=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class x extends m.Z{constructor(e){super(),this.gs=e}open(e={}){return C(this,void 0,void 0,(function*(){const[t]=yield Promise.all([this.fetch(e),this.gs.loadOverlay()]);this.gs.overlay.openLeaderboard(e,t),this._events.emit("open")}))}openScoped(e){return C(this,void 0,void 0,(function*(){const[t]=yield Promise.all([this.fetchScoped(e),this.gs.loadOverlay()]),n=Object.assign({},e),i=t.fields.map((e=>e.key));n.orderBy=e.includeFields?i.filter((t=>!e.includeFields.includes(t))):i,this.gs.overlay.openLeaderboard(n,t),this._events.emit("open")}))}fetch(e={}){return C(this,void 0,void 0,(function*(){const t=(0,r._)();this.gs.loader.inc();try{const{result:n,playerResult:i}=yield this.gs._leaderboardsService.getRating(e);n.players=T(n.players,e.withMe,null==i?void 0:i.player),t.done(n),this._events.emit("fetch",n)}catch(e){t.abort(e),this._events.emit("error:fetch")}finally{this.gs.loader.dec()}return t.ready}))}fetchScoped(e){return C(this,void 0,void 0,(function*(){const t=(0,r._)();this.gs.loader.inc();try{const n=yield this.gs._leaderboardsService.getRatingVariant(e),{result:i,playerResult:r}=n;(0,k.t)(i),(0,k.t)(r),i.players=T(i.players,e.withMe,null==r?void 0:r.player),t.done(i),this._events.emit("fetch",i)}catch(e){t.abort(e),this._events.emit("error:fetch")}finally{this.gs.loader.dec()}return t.ready}))}fetchPlayerRating(e={}){return C(this,void 0,void 0,(function*(){const t=(0,r._)();this.gs.loader.inc();try{const n=yield this.gs._leaderboardsService.getPlayerRating(e);t.done(n),this._events.emit("fetchPlayer",n)}catch(e){t.abort(e),this._events.emit("error:fetchPlayer",e)}finally{this.gs.loader.dec()}return t.ready}))}fetchPlayerRatingScoped(e){return C(this,void 0,void 0,(function*(){const t=(0,r._)();this.gs.loader.inc();try{const n=yield this.gs._leaderboardsService.getPlayerRatingVariant(e);t.done(n),this._events.emit("fetchPlayerScoped",n)}catch(e){t.abort(e),this._events.emit("error:fetchPlayerScoped",e)}finally{this.gs.loader.dec()}return t.ready}))}publishRecord(e){return C(this,void 0,void 0,(function*(){const t=(0,r._)();this.gs.loader.inc();try{const n=yield this.gs._leaderboardsService.publishRecord(e);t.done(n),this._events.emit("publishRecord",n)}catch(e){t.abort(e),this._events.emit("error:publishRecord",e)}finally{this.gs.loader.dec()}return t.ready}))}}function T(e,t,n){if(!n||!t||"none"===t)return e;if(e.some((e=>e.id===n.id&&e.position===n.position)))return e;const i=e.length,r=n.position-1;if(e=e.filter((e=>e.id!==n.id)),r<i)e.splice(r,0,n),e.forEach(((e,t)=>{t<=r||e.position++})),e.length>i&&e.pop();else switch(t){case"first":console.log("FIRST!"),e.unshift(n);break;case"last":console.log("LAST!"),e.push(n)}return e}S([E(500)],x.prototype,"open",null),S([E(500)],x.prototype,"openScoped",null),S([E(500)],x.prototype,"fetch",null),S([E(500)],x.prototype,"fetchScoped",null),S([E(500)],x.prototype,"fetchPlayerRating",null),S([E(500)],x.prototype,"fetchPlayerRatingScoped",null),S([E(500)],x.prototype,"publishRecord",null);const I={data:e=>String(e||""),stats:e=>Number(e)||0,flag:e=>Boolean(e)||!1,service:null,accounts:null},O=["name","avatar"];class A extends m.Z{constructor(e={},t){super(),this.fields=t,this.fromJSON(e)}get id(){return this.state.id}get score(){return this.get("score")}set score(e){this.set("score",e)}get name(){return this.get("name")}set name(e){this.set("name",e)}get avatar(){return this.get("avatar")}set avatar(e){this.set("avatar",e)}get isStub(){return!this.fields.filter((e=>!O.includes(e.key))).some((e=>this.get(e.key)!==e.default))}fromJSON(e){var t,n,i,r;this.state={id:e.id||0,active:null===(t=e.active)||void 0===t||t,removed:null!==(n=e.removed)&&void 0!==n&&n,banned:null!==(i=e.banned)&&void 0!==i&&i,test:null!==(r=e.test)&&void 0!==r&&r,name:e.name||"",avatar:e.avatar||"",score:e.score||0},this.fields.forEach((t=>{if(!(t.key in e))return void(this.state[t.key]=t.default);const n=I[t.type];if(!n)return void(this.state[t.key]=e[t.key]||t.default);const i=n(e[t.key]);this.state[t.key]=t.variants.length&&!t.variants.some((e=>e.value===i))?t.default:i})),this._events.emit("change")}toJSON(){return Object.assign({},this.state)}getField(e){const t=this.fields.find((t=>t.key===e));if(!t){const t=`Field "${e}" not exists on player model`;throw u.kg.error(t),new Error(t)}return t}getFieldName(e){return this.getField(e).name||""}getFieldVariantName(e,t){var n;return(null===(n=this.getField(e).variants.find((e=>e.value===t)))||void 0===n?void 0:n.name)||""}get(e){return this.state[e]}set(e,t){const n=this.getField(e),i=I[n.type];if(!i){const t=`Cannot mutate "${e}", it's readonly`;throw u.kg.error(t),new Error(t)}const r=i(t);if(n.variants.length&&!n.variants.some((e=>e.value===r))){const t=`Invalid variant ${r} of "${e}"`;throw u.kg.error(t),new Error(t)}this.state[e]=r,this._events.emit("change")}add(e,t){return this.set(e,this.get(e)+t)}toggle(e){return this.set(e,!this.get(e))}has(e){return Boolean(this.get(e))}reset(){this.fields.forEach((e=>this.set(e.key,e.default)))}remove(){this.state.id=0,this.reset()}}var j,$,L,M,R,F=function(e,t,n,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},N=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},D=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},B=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class U extends A{constructor(e={},t,n,i,s){super(e,t),this.playerAdapter=n,this.gs=i,this.isLoggedIn=!1,this.isLoggedInByPlatform=!1,this.hasAnyCredentials=!1,this.secretCode="",this.tempSecredCode="",this._hasFirstSync=!1,j.set(this,{}),$.set(this,""),L.set(this,void 0),M.set(this,(function({silent:e=!0,override:t=!1}={}){return N(this,void 0,void 0,(function*(){this.gs.loader.inc();const n=(0,r._)();this.gs._storage.savePlayer(this.toJSON()).catch(u.kg.warn);try{let i;if(e?this._isRequredDataUpdate&&(i=this.playerAdapter.getPlayer()):i=this.playerAdapter.loginPlayer(this),i){const t=yield i.catch((()=>({name:"",photoLarge:""})));t.name&&!this.get("name")&&(this.name=t.name),t.photoLarge&&this._isRequredAvatarUpdate&&(this.avatar=t.photoLarge),e||(yield this._initContext())}const r=yield this.gs._playerService.sync({override:t,playerState:this.toJSON()});switch(r.__typename){case"PlayerSyncConflict":{this.gs.loader.dec();const t=r;yield this.gs.loadOverlay();const i=yield this.gs.overlay.pickPlayerOnConflict(t);this.gs.loader.inc(),this.has("name")&&!i.name&&(i.name=this.get("name")),this.has("avatar")&&!i.avatar&&(i.avatar=this.get("avatar"));const s=yield this.gs._playerService.sync({playerState:i,override:!0});if("Player"!==s.__typename)return void n.abort();e||this.setSecretCode(""),this.gs.overlay.close(),this.gs.achievements._setUnlockedList(s.achievements),this.gs.payments._setPurchasedList(s.purchases),this.fromJSON(s.state),D(this,$,s.state.secretCode,"f"),B(this,L,"f").call(this,this._authInfo),this.gs._storage.savePlayer(s.state),n.done(),yield this.checkLoggedIn(s.state);break}case"Player":{const{state:t,achievements:i,purchases:s}=r;e||this.setSecretCode(""),this.gs.achievements._setUnlockedList(i),this.gs.payments._setPurchasedList(s),this.fromJSON(t),D(this,$,t.secretCode,"f"),B(this,L,"f").call(this,this._authInfo),this.gs._storage.savePlayer(t),n.done(),yield this.checkLoggedIn(t);break}}}catch(e){n.abort(e)}finally{this._hasFirstSync=!0,this.gs.loader.dec()}return n.ready.then((()=>this._events.emit("sync",!0))).catch((()=>this._events.emit("sync",!1))),n.ready}))})),R.set(this,(function(){return N(this,void 0,void 0,(function*(){this.gs.loader.inc();try{const e=yield this.gs._playerService.getPlayer();this.gs.achievements._setUnlockedList(e.achievements),this.gs.payments._setPurchasedList(e.purchases),this.fromJSON(e.state),D(this,$,e.state.secretCode,"f"),B(this,L,"f").call(this,this._authInfo),this.gs._storage.savePlayer(e.state),yield this.checkLoggedIn(e.state),this._events.emit("load",!0)}catch(e){u.kg.error(e),this._events.emit("load",!1)}finally{this.gs.loader.dec()}}))}));const o=(0,r._)();this.ready=o.ready,D(this,L,s,"f"),this._initContext().finally((()=>this._init(o)))}get avatar(){return this.get("avatar")||this.gs.generateAvatar(this.id,64)}set avatar(e){this.set("avatar",e)}get _isRequredDataUpdate(){return!this.get("name")||this._isRequredAvatarUpdate}get _isRequredAvatarUpdate(){const e=this.get("avatar");return!e||!this._hasFirstSync&&this.playerAdapter.isPlatformAvatar(e)}get _authInfo(){return Object.assign(Object.assign({},B(this,j,"f")),{secretCode:this.secretCode||B(this,$,"f")})}get(e){return"secretCode"===e?this.secretCode||B(this,$,"f"):super.get(e)}_initContext(){return N(this,void 0,void 0,(function*(){const{platformData:e,key:t}=yield this.playerAdapter.getPlayerContext().catch((e=>(u.kg.error(e),{platformData:null,key:""})));D(this,j,e||{},"f"),B(this,L,"f").call(this,this._authInfo);const n=`,${this.gs.platform.type},${this.gs.isDev?"d":"p"},${t}`;if(null==e?void 0:e.savedState){u.kg.info("found saved state...");const e=`,${this.gs.platform.type},${this.gs.isDev?"d":"p"},null`,[t]=yield this.gs._storage.extractFromContext(e);t&&(this.fromJSON(t),yield B(this,M,"f").call(this),yield this.gs._storage.copyFromContext(n,e))}if(this.gs.platform.type===i.z.SMARTMARKET){const e=`,SBER_MARKET,${this.gs.isDev?"d":"p"},`,[t]=yield this.gs._storage.extractFromContext(e);t&&(delete t.platformType,this.fromJSON(t),yield B(this,M,"f").call(this),yield this.gs._storage.clearContext(e))}if(!this.gs._storage.isEmptyOnBoot&&this.gs._storage.isEmptyContext()){u.kg.info("Applying migration...");const[e,t]=yield this.gs._storage.migrateToContext(n);this.secretCode=t,this.fromJSON(e),D(this,$,e.secretCode,"f"),B(this,L,"f").call(this,this._authInfo),yield B(this,M,"f").call(this)}this.gs._storage.setContext(n)}))}_init(e){return N(this,void 0,void 0,(function*(){Promise.all([this.gs._storage.loadPlayer(),this.gs._storage.loadSecretCode(),this.gs.ready]).then((([t,n])=>{this.fromJSON(t||{}),D(this,$,(null==t?void 0:t.secretCode)||"","f"),this.secretCode=n,B(this,L,"f").call(this,this._authInfo),(this.id?B(this,R,"f").call(this):B(this,M,"f").call(this)).finally((()=>{e.done(),this._events.emit("ready"),this.isLoggedInByPlatform&&this.gs.payments._sync()}))}))}))}fetchFields(){return N(this,void 0,void 0,(function*(){try{this.fields=(yield this.gs._playerService.fetchFields()).items,this._events.emit("fetchFields",!0)}catch(e){this._events.emit("fetchFields",!1)}}))}sync(e={}){return N(this,void 0,void 0,(function*(){return B(this,M,"f").call(this,e)}))}load(){return N(this,void 0,void 0,(function*(){return B(this,R,"f").call(this)}))}login(){return N(this,void 0,void 0,(function*(){if(this.gs.platform._hasAuthModal)return void this.playerAdapter.loginPlayer(this);yield this.gs.loadOverlay();const{type:e,secretCode:t}=yield this.gs.overlay.login();switch(e){case"PLATFORM_AUTH":yield B(this,M,"f").call(this,{silent:!1}).then((()=>this._events.emit("login",!0))).catch((e=>{u.kg.error(e),this._events.emit("login",!1)}));break;case"SECRET_KEY_AUTH_LOGIN":this.setSecretCode(t),yield B(this,R,"f").call(this).then((()=>this._events.emit("login",!0))).catch((e=>{u.kg.error(e),this._events.emit("login",!1)}))}this.gs.overlay.close()}))}checkLoggedIn(e){return N(this,void 0,void 0,(function*(){this.isStub?(this.tempSecredCode=e.secretCode,this.setSecretCode(e.secretCode)):this.tempSecredCode&&this.tempSecredCode===e.secretCode&&(this.setSecretCode(""),this.tempSecredCode=""),this.isLoggedInByPlatform=this.playerAdapter.hasCredetials,this.isLoggedIn=this.isLoggedInByPlatform,this.hasAnyCredentials=this.isLoggedIn||!!this.secretCode,this.secretCode&&this.secretCode!=e.secretCode&&this.setSecretCode(e.secretCode),this.hasAnyCredentials||(this.setSecretCode(e.secretCode),this.hasAnyCredentials=!0)}))}setSecretCode(e){this.secretCode=e,this.gs._storage.saveSecretCode(this.secretCode),B(this,L,"f").call(this,this._authInfo)}}j=new WeakMap,$=new WeakMap,L=new WeakMap,M=new WeakMap,R=new WeakMap,F([E(300)],U.prototype,"fetchFields",null),F([E(300)],U.prototype,"sync",null),F([E(300)],U.prototype,"load",null);class W extends m.Z{constructor(){super(),document.documentElement.addEventListener("fullscreenchange",(()=>{let e=this.isEnabled;this._events.emit("change",e),this._events.emit(e?"open":"close")}))}get isEnabled(){return Boolean(document.fullscreenElement||document.webkitFullscreenElement)}open(){this.isEnabled||(document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen())}close(){this.isEnabled&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}toggle(){this.isEnabled?this.close():this.open()}}class z{constructor(){this.counters=[]}addCounter(e){return t=this,n=void 0,r=function*(){this.counters.push(e)},new((i=void 0)||(i=Promise))((function(e,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}c((r=r.apply(t,n||[])).next())}));var t,n,i,r}hit(e){this.counters.forEach((t=>t.hit(e)))}goal(e,t){this.counters.forEach((n=>n.goal(e,t)))}}var Z=o(4917),q=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class G{constructor({counterId:e}){this.counterId=e;const t=window;t.ym=t.ym||function(){(t.ym.a=t.ym.a||[]).push(arguments),t.ym.l=Date.now()},t.ym(e,"init",{accurateTrackBounce:!0}),this.ym=window.ym,(0,Z.Z)({src:"/patch/js/null.js?mc.yandex.ru/metrika/tag.js"})}hit(e){return q(this,void 0,void 0,(function*(){this.ym(this.counterId,"hit",e)}))}goal(e,t){return q(this,void 0,void 0,(function*(){this.ym(this.counterId,"reachGoal",t?`${e}_${t}`:e)}))}}var K=o(9991),J=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class V{constructor({counterId:e}){this.counterId=e;const t=window;t.dataLayer=t.dataLayer||[],t.dataLayer.push("js",new Date),t.dataLayer.push("config",e,{send_page_view:!1}),(0,Z.Z)({src:`//www.googletagmanager.com/gtag/js?id=${e}`}),this.ready=(0,K.Z)((e=>"gtag"in e)).then((()=>this.gtag=window.gtag))}hit(e){return J(this,void 0,void 0,(function*(){yield this.ready,this.gtag("event","page_view",{page_location:e,send_to:this.counterId})}))}goal(e,t){return J(this,void 0,void 0,(function*(){yield this.ready,this.gtag("event",e,t?{value:t}:void 0)}))}}var Y=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class H extends m.Z{constructor(e,t){super(),this.adapter=e,this.gs=t}get isSupportsShare(){return this.adapter.isSupportsShare}get isSupportsNativeShare(){return this.adapter.isSupportsNativeShare}get isSupportsNativePosts(){return this.adapter.isSupportsNativePosts}get isSupportsNativeInvite(){return this.adapter.isSupportsNativeInvite}get isSupportsNativeCommunityJoin(){return this.adapter.isSupportsNativeCommunityJoin}get canJoinCommunity(){return this.adapter.canJoinCommunity&&!!this.communityLink}get communityLink(){return this.gs.platform.config.communityLink}_getShareOptions(e){return{text:e.text||this.gs.app.title,image:e.image||"",url:e.url||this.gs.app.url}}_shareByOverlay(e,t){var n;return Y(this,void 0,void 0,(function*(){if(this.gs.isMobile)try{const e=this._getShareOptions(t),i=Object.assign({},e);if(e.image){const t=yield fetch(e.image).then((e=>e.blob()));i.files=[new File([t],"image.png",{type:t.type,lastModified:(new Date).getTime()})]}const r=window.navigator;if(null===(n=r.canShare)||void 0===n?void 0:n.call(r,i))return r.share(i)}catch(e){u.kg.warn(e)}return yield this.gs.loadOverlay(),this.gs.overlay.share(e,this._getShareOptions(t))}))}share(e={}){return Y(this,void 0,void 0,(function*(){if(!this.isSupportsShare)return this._events.emit("share",!1),!1;const t=this.isSupportsNativeShare?this.adapter.share(this._getShareOptions(e)):this._shareByOverlay("share",e),n=yield t.catch((()=>!1));return this._events.emit("share",n),n}))}post(e={}){return Y(this,void 0,void 0,(function*(){if(!this.isSupportsShare)return this._events.emit("post",!1),!1;const t=this.isSupportsNativePosts?this.adapter.post(this._getShareOptions(e)):this._shareByOverlay("post",e),n=yield t.catch((()=>!1));return this._events.emit("post",n),n}))}invite(e={}){return Y(this,void 0,void 0,(function*(){if(!this.isSupportsShare)return this._events.emit("invite",!1),!1;const t=this.isSupportsNativeInvite?this.adapter.invite(this._getShareOptions(e)):this._shareByOverlay("invite",e),n=yield t.catch((()=>!1));return this._events.emit("invite",n),n}))}joinCommunity(){return Y(this,void 0,void 0,(function*(){if(!this.canJoinCommunity)return this._events.emit("joinCommunity",!1),!1;let e=!0;return this.isSupportsNativeCommunityJoin&&(e=yield this.adapter.joinCommunity(this.gs.platform.config.community)),window.open(this.communityLink,"_blank"),this._events.emit("joinCommunity",e),e}))}}class X extends m.Z{constructor(e,t,n){var i,r,s,o,a;super(),this.gs=e,this.adapter=t,this.config=n,this.title=(null===(i=document.querySelector('meta[name="og:title"]'))||void 0===i?void 0:i.getAttribute("content"))||(null===(r=document.querySelector("title"))||void 0===r?void 0:r.innerText)||"",this.description=(null===(s=document.querySelector('meta[name="og:description"]'))||void 0===s?void 0:s.getAttribute("content"))||(null===(o=document.querySelector('meta[name="description"]'))||void 0===o?void 0:o.getAttribute("content"))||"",this.image=(null===(a=document.querySelector('meta[name="og:image"]'))||void 0===a?void 0:a.getAttribute("content"))||""}get url(){return this.config.platformConfig.gameLink||this.gs.platform.getSDK().appUrl}get canAddShortcut(){return this.adapter.canAddShortcut}addShortcut(){return e=this,t=void 0,i=function*(){const e=yield this.adapter.addShortcut();return this._events.emit("addShortcut",e),e},new((n=void 0)||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}));var e,t,n,i}}var Q=o(584);function ee(e){const t=(0,r._)(r.s),n=new Image;return n.onload=()=>t.done(n),n.onerror=()=>t.abort(),n.onabort=()=>t.abort(),n.src=e,t.ready}var te,ne,ie,re,se=o(4835),oe=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},ae=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class ce extends m.Z{constructor(e){super(),this.gs=e,te.set(this,[]),ne.set(this,[]),ie.set(this,{})}get unlockedList(){return[...ae(this,ne,"f")]}open({scrollTo:e}={}){return oe(this,void 0,void 0,(function*(){this.gs.loader.inc();try{const[t]=yield Promise.all([this.fetch(),this.gs.loadOverlay(),ee(se.Z.app.trophy).catch(u.kg.error)]);this.gs.loader.dec(),t.achievements.length>0?(this._events.emit("open"),yield this.gs.overlay.openAchievements(t,{scrollTo:e}).catch(u.kg.error),this._events.emit("close")):u.kg.error(new Error("Empty achievements list"))}catch(e){this.gs.loader.dec(),u.kg.error(e)}}))}fetch(){return oe(this,void 0,void 0,(function*(){const e=(0,r._)();this.gs.loader.inc();try{const t=yield this.gs._achievementsService.fetch();if(!t)throw new Error("can't fetch achievements list");const n=t.playerAchievements.map((e=>{var n;return{id:e.achievementId,tag:(null===(n=t.achievements.find((t=>t.id===e.achievementId)))||void 0===n?void 0:n.tag)||"",createdAt:e.createdAt}}));ae(this,ne,"f").push(...n.filter((e=>!ae(this,ne,"f").some((t=>t.id===e.id))))),e.done(t),this._events.emit("fetch",t)}catch(t){e.abort(t),this._events.emit("error:fetch")}finally{this.gs.loader.dec()}return e.ready}))}unlock({id:e,tag:t}){return oe(this,void 0,void 0,(function*(){const n=e||t;if(ae(this,ie,"f")[n])return ae(this,ie,"f")[n];const i=(0,r._)(),s=e=>{i.done({success:!1,achievement:null,error:e}),this._events.emit("error:unlock",e)};if(this.has(t||e))return s("already_unlocked"),i.ready;if(ae(this,te,"f").includes(n))return s("achievement_not_found"),i.ready;ae(this,ie,"f")[n]=i,this.gs.loader.inc();const o=this.gs.loadOverlay();try{const n=yield this.gs._achievementsService.unlock({id:e,tag:t});ae(this,ne,"f").push(Object.assign({},n)),this._events.emit("unlock",n),Promise.all([o,ee(n.iconSmall||se.Z.cdn.trophy).catch(u.kg.error)]).then((()=>{this.gs.overlay.unlockAchievement(n)})),i.done({achievement:n,success:!0,error:""})}catch(e){"achievement_not_found"===e&&ae(this,te,"f").push(n),"string"==typeof e?(u.kg.error(e),s(e)):(i.abort(e),this._events.emit("error:unlock",e))}finally{this.gs.loader.dec()}return i.ready.finally((()=>{delete ae(this,ie,"f")[n]})),i.ready}))}has(e){return ae(this,ne,"f").some((t=>t.tag===e||t.id===e))}_setUnlockedList(e){!function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,ne,[...e],"f")}}function le(e){return new Promise((function(t,n){e.oncomplete=e.onsuccess=function(){return t(e.result)},e.onabort=e.onerror=function(){return n(e.error)}}))}function he(e,t){var n=indexedDB.open(e);n.onupgradeneeded=function(){return n.result.createObjectStore(t)};var i=le(n);return function(e,n){return i.then((function(i){return n(i.transaction(t,e).objectStore(t))}))}}function de(){return re||(re=he("keyval-store","keyval")),re}te=new WeakMap,ne=new WeakMap,ie=new WeakMap;class ue{constructor(e){this.projectId=e;try{this.store=he(`gs-db-project-${this.projectId}`,"storage")}catch(e){u.kg.error(e)}}set(e,t){return this.store?function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:de())("readwrite",(function(n){return n.put(t,e),le(n.transaction)}))}(e,t,this.store).catch((()=>null)):Promise.resolve()}get(e){if(!this.store)return Promise.resolve(null);const t=(0,r._)({timeout:2e3});return function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:de())("readonly",(function(t){return le(t.get(e))}))}(e,this.store).then(t.done).catch((()=>t.done(null))),t.ready}}var fe,pe=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},ve=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class ge{constructor(e){this.projectId=e,fe.set(this,void 0);try{!function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,fe,window.localStorage,"f")}catch(e){}}getKey(e){return`gs-db-project-${this.projectId}-${e}`}set(e,t){return pe(this,void 0,void 0,(function*(){ve(this,fe,"f").setItem(this.getKey(e),JSON.stringify(t))}))}get(e){return pe(this,void 0,void 0,(function*(){try{return JSON.parse(ve(this,fe,"f").getItem(this.getKey(e))||"null")}catch(e){}}))}}fe=new WeakMap;var ye,me=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const we="{\n    id\n    icon(w: 256, h: 256, crop: false)\n    iconSmall: icon(w: 48, h: 48, crop: false)\n    tag\n    price\n    name(lang: $lang)\n    description(lang: $lang)\n    yandexId\n}",be="productId, payload, createdAt",_e=`query ($input: FindPlayerPurchaseInput!, $lang: Lang) {\n    result: FindPlayerPurchase(input: $input) {\n        __typename\n        ... on Problem { message }\n        ... on PlayerPurchaseOutput {\n            product ${we}\n        }\n    }\n}`,Pe=`mutation ($input: PurchasePlayerPurchaseInput!, $lang: Lang) {\n    result: PurchasePlayerPurchase(input: $input) {\n        __typename\n        ... on Problem { message }\n        ... on PlayerPurchaseOutput {\n            product ${we}\n            purchase { ${be} }\n        }\n    }\n}`,Ee=`mutation ($input: ConsumePlayerPurchaseInput!, $lang: Lang) {\n    result: ConsumePlayerPurchase(input: $input) {\n        __typename\n        ... on Problem { message }\n        ... on PlayerPurchaseOutput {\n            product ${we}\n            purchase { ${be}, gift }\n        }\n    }\n}`,ke=`query ($lang: Lang) {\n    result: FetchPlayerPurchases {\n        __typename\n        ... on Problem { message }\n        ... on PlayerPurchasesOutput {\n            products ${we}\n            playerPurchases { ${be} }\n        }\n    }\n}`;class Se{constructor(e){ye.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,ye,e,"f")}sync({purchases:e,payload:t}){return me(this,ye,"f").fetch("mutation ($input: SyncPlayerPurchasesInput!) {\n    result: SyncPlayerPurchases(input: $input) {\n        __typename\n        ... on Problem { message }\n        ... on PlayerProductsPurchasedOutput {\n            playerPurchases { id, tag, createdAt }\n        }\n    }\n}",{purchases:e,payload:t})}fetch(){return me(this,ye,"f").fetch(ke)}purchase({payload:e,id:t,tag:n}){return me(this,ye,"f").fetch(Pe,{payload:e,id:t,tag:n})}findProduct({id:e,tag:t}){return me(this,ye,"f").fetch(_e,{id:e,tag:t})}consume({id:e,tag:t}){return me(this,ye,"f").fetch(Ee,{id:e,tag:t})}}ye=new WeakMap;var Ce,xe,Te,Ie=o(4687),Oe=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},Ae=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},je=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n};class $e{constructor(e,t,n,i,r){this.apiUrl=e,this.projectId=t,this.publicToken=n,this.lang=i,this.platformType=r,Ce.set(this,""),xe.set(this,0),Te.set(this,(()=>{}))}get reqCounter(){return Ae(this,xe,"f")}set reqCounter(e){je(this,xe,e,"f"),Ae(this,Te,"f").call(this,e)}addCounterListener(e){je(this,Te,e,"f")}setLang(e){this.lang=e}setPlayerData(e){je(this,Ce,btoa(JSON.stringify(e)),"f")}signQuery(e=null){return Oe(this,void 0,void 0,(function*(){const t={projectId:this.projectId,query:Le(e),token:this.publicToken},n=yield function(e){return t=this,n=void 0,r=function*(){const t=(new TextEncoder).encode(e),n=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")},new((i=void 0)||(i=Promise))((function(e,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}c((r=r.apply(t,n||[])).next())}));var t,n,i,r}(JSON.stringify(t));return{input:e,hash:n}}))}fetch(e,t,n){return Oe(this,void 0,void 0,(function*(){return this.fetchMany(e,t,n).then((({result:e})=>((0,k.t)(e),e)))}))}fetchMany(e,t,n={}){return Oe(this,void 0,void 0,(function*(){const{input:i,hash:r}=yield this.signQuery(t);let s,o={};const a=JSON.stringify({query:e,variables:Object.assign({input:i,lang:this.lang.toUpperCase()},n)}),c=function(e={}){return Object.keys(e).filter((t=>e[t]instanceof File))}(t);if(c.length>0){s=new FormData,s.append("operations",a);const e={};c.forEach(((n,i)=>{e[i]=[`variables.input.${n}`],s.append(i,t[n])})),s.append("map",JSON.stringify(e))}else o={"Content-Type":"application/json;charset=utf-8"},s=a;return fetch(this.apiUrl,{body:s,method:"POST",headers:Object.assign(Object.assign({},o),{"X-Transaction-Token":r,"X-Platform":this.platformType,"X-Project-ID":String(this.projectId),"X-Project-Token":this.publicToken,"X-Language":this.lang,"X-Player-Data":Ae(this,Ce,"f")})}).then((e=>Oe(this,void 0,void 0,(function*(){if(!e.ok){const t=yield e.text();throw new Error(`${e.status}. ${t}`)}const t=yield e.json();return Object.values(t.data).forEach((e=>{"Problem"!=e.__typename&&this.reqCounter++})),t})))).then((e=>e.data))}))}}function Le(e){var t;return Array.isArray(e)?e.map(Le):null!==e&&"object"==typeof e?(Object.getOwnPropertySymbols(e).length>0&&(e=JSON.parse(JSON.stringify(e))),t={},Object.keys(e).sort().forEach((n=>t[n]=Le(e[n]))),t):e}Ce=new WeakMap,xe=new WeakMap,Te=new WeakMap;var Me;class Re{constructor(e){Me.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,Me,e,"f")}fetch({id:e,tag:t,urlFrom:n}){return function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}(this,Me,"f").fetch("\nfragment project on Project {\n    id\n    url(from: $url)\n    name(lang: $lang)\n    description(lang: $lang)\n    assets {\n        icon {\n            resources { src(w: 256, h: 256, crop: true) }\n        }\n    }\n}\nquery ($input: FetchPlayerGamesCollectionInput!, $lang: Lang, $url: String) {\n    result: FetchPlayerGamesCollection(input: $input) {\n        __typename\n        ... on GamesCollection {\n            id\n            tag\n            name(lang: $lang)\n            description(lang: $lang)\n            games { ...project }\n        }\n        ... on Problem { message }\n    }\n}",{id:e,tag:t},{url:n})}}Me=new WeakMap;var Fe=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const Ne=e=>{var t;return(null===(t=null==e?void 0:e.resources[0])||void 0===t?void 0:t.src)||""},De=e=>{var{assets:t}=e,n=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["assets"]);return Object.assign(Object.assign({},n),{icon:Ne(t.icon)})},Be=[i.z.YANDEX,i.z.VK,i.z.OK,i.z.GAMEPIX];class Ue extends m.Z{constructor(e){super(),this.gs=e}get isAvailable(){return this.gs.platform.isExternalLinksAllowed||Be.includes(this.gs.platform.type)}open({id:e,tag:t}={tag:"ALL"}){return Fe(this,void 0,void 0,(function*(){if(this.isAvailable){this.gs.loader.inc();try{const[n]=yield Promise.all([this.fetch({id:e,tag:t}),this.gs.loadOverlay(),ee(se.Z.app.trophy).catch(u.kg.error)]);this.gs.loader.dec(),n.games.length>0&&(this._events.emit("open"),yield this.gs.overlay.openGamesCollections(n).catch(u.kg.error),this._events.emit("close"))}catch(e){this.gs.loader.dec(),u.kg.error(e)}}else u.kg.warn(`Not available on ${this.gs.platform.type}`)}))}fetch({id:e,tag:t}={tag:"ALL"}){return Fe(this,void 0,void 0,(function*(){if(!this.isAvailable)return void u.kg.warn(`Not available on ${this.gs.platform.type}`);const n=(0,r._)();this.gs.loader.inc();try{const i=yield this.gs._gamesCollectionsService.fetch({id:e,tag:t,urlFrom:this.gs.app.url});if(!i)throw new Error("can't fetch GamesCollections list");const r=Object.assign(Object.assign({},i),{games:i.games.filter((e=>e.url)).map(De)});r.games||u.kg.warn("empty games collection"),n.done(r),this._events.emit("fetch",r)}catch(e){n.abort(e),this._events.emit("error:fetch")}finally{this.gs.loader.dec()}return n.ready}))}}var We,ze=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},Ze=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const qe=`\n    ... on PlayersTop {\n        leaderboard {\n            id\n            tag\n            name(lang: $lang),\n            description(lang: $lang),\n            shareText(lang: $lang),\n            isAuthorizedOnly\n        }\n        players\n        fields { ${s.S} }\n    }\n`,Ge=`\n    ... on PlayerTop {\n        player\n        fields { ${s.S} }\n    }\n`,Ke=`\n    ... on PlayerRecord {\n        record\n        fields { ${s.S} }\n    }\n`,Je=`query ($input: FetchTopInput!, $lang: Lang, $withMe: Boolean!) {\n    result: FetchTop(input: $input) {${(0,k.M)(qe)}}\n    playerResult: FetchPlayerRating(input: $input) @include(if: $withMe) {${(0,k.M)(Ge)}}\n}`,Ve=`query ($input: FetchTopInput!, $lang: Lang) {\n    result: FetchPlayerRating(input: $input) {${(0,k.M)(Ge)}}\n}`,Ye=`query ($input: FetchPlayerTopScopedInput!, $lang: Lang, $withMe: Boolean!) {\n    result: FetchPlayerTopScoped(input: $input) {${(0,k.M)(qe)}}\n    playerResult: FetchPlayerRatingScoped(input: $input) @include(if: $withMe) {${(0,k.M)(Ge)}}\n}`,He=`query ($input: FetchPlayerTopScopedInput!, $lang: Lang) {\n    result: FetchPlayerRatingScoped(input: $input) {${(0,k.M)(Ge)}}\n}`,Xe=`mutation ($input: PlayerPublishRecordInput!, $lang: Lang) {\n    result: PlayerPublishRecord(input: $input) {${(0,k.M)(Ke)}}\n}`;class Qe{constructor(e){We.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,We,e,"f")}getRating({orderBy:e=["score"],includeFields:t=[],order:n="DESC",limit:i=10,withMe:r="none"}){return ze(this,void 0,void 0,(function*(){return Ze(this,We,"f").fetchMany(Je,{orderBy:e,order:n,limit:i,includeFields:t},{withMe:"none"!==r})}))}getPlayerRating({orderBy:e=["score"],includeFields:t=[],order:n="DESC",limit:i=10}){return ze(this,void 0,void 0,(function*(){return Ze(this,We,"f").fetch(Ve,{orderBy:e,order:n,limit:i,includeFields:t})}))}getRatingVariant({id:e,tag:t,variant:n,includeFields:i=[],limit:r=10,withMe:s="none",order:o}){return ze(this,void 0,void 0,(function*(){return Ze(this,We,"f").fetchMany(Ye,{id:e,tag:t,variant:n,limit:r,includeFields:i,order:o},{withMe:"none"!==s})}))}getPlayerRatingVariant({id:e,tag:t,variant:n,includeFields:i=[],limit:r=10,order:s}){return ze(this,void 0,void 0,(function*(){return Ze(this,We,"f").fetch(He,{id:e,tag:t,variant:n,limit:r,includeFields:i,order:s})}))}publishRecord({id:e,tag:t,variant:n,record:i,override:r}){return ze(this,void 0,void 0,(function*(){return Ze(this,We,"f").fetch(Xe,{id:e,tag:t,variant:n,record:i,override:r})}))}}We=new WeakMap;var et;class tt{constructor(e){et.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,et,e,"f")}fetch({type:e,format:t}){return function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}(this,et,"f").fetch("query($input: FetchPlayerDocumentInput!, $lang: Lang, $format: DocumentFormat) {\n    result: FetchPlayerDocument(input: $input) {\n        __typename\n        ... on Problem { message }\n        ... on Document {\n            type\n            content(lang: $lang, format: $format)\n        }\n    }\n}",{type:e},{format:t})}}et=new WeakMap;var nt=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class it extends m.Z{constructor(e){super(),this.gs=e}open({type:e}){return nt(this,void 0,void 0,(function*(){this.gs.loader.inc();try{const[t]=yield Promise.all([this.fetch({type:e}),this.gs.loadOverlay(),ee(se.Z.app.trophy).catch(u.kg.error)]);this.gs.loader.dec(),t?(t.format="HTML",this._events.emit("open"),yield this.gs.overlay.openDocument(t).catch(u.kg.error),this._events.emit("close")):u.kg.error(new Error("document not found"))}catch(e){this.gs.loader.dec(),u.kg.error(e)}}))}fetch({type:e,format:t="HTML"}){return nt(this,void 0,void 0,(function*(){const n=(0,r._)();this.gs.loader.inc();try{const i=yield this.gs._documentsService.fetch({type:e,format:t});if(!i)throw new Error("can't fetch privacy policy");i.format=t,n.done(i),this._events.emit("fetch",i)}catch(e){n.abort(e),this._events.emit("error:fetch",e)}finally{this.gs.loader.dec()}return n.ready}))}}var rt,st=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const ot={data:e=>String(e||""),stats:e=>Number(e)||0,flag:e=>Boolean(e)||!1,image:e=>String(e||""),doc_html:e=>String(e||""),file:e=>String(e||"")};class at extends m.Z{constructor(e,t){super(),this.gs=e,this.state={},this.list=[],rt.set(this,(function(e){this.state={},this.list=e,e.forEach((e=>{var t;const n=(null===(t=ot[e.type])||void 0===t?void 0:t.call(ot,e.value))||e.value;this.state[e.key]=n})),this._events.emit("change")})),st(this,rt,"f").call(this,t)}get(e){return this.state[e]}has(e){return Boolean(this.get(e))}type(e){var t;return(null===(t=this.list.find((t=>t.key===e)))||void 0===t?void 0:t.type)||"data"}fetch(){return e=this,t=void 0,i=function*(){try{const e=(yield this.gs._projectService.fetchVariables()).items;return st(this,rt,"f").call(this,e),this._events.emit("fetch",e),e}catch(e){u.kg.error(e),this._events.emit("error:fetch",e)}},new((n=void 0)||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}));var e,t,n,i}}rt=new WeakMap,function(e,t,n,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);s>3&&o&&Object.defineProperty(t,n,o)}([E(300)],at.prototype,"fetch",null);var ct,lt=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const ht="\n    id: _id\n    playerId\n    src\n    tags\n    width\n    height\n",dt=`\n    ... on ImagesList {\n        items { ${ht} }\n    }\n`,ut=`\n    ... on Image { ${ht} }\n`,ft=`query($input: FetchPlayerImagesInput!) {\n    result: FetchPlayerImages(input: $input) { ${(0,k.M)(dt)} }\n}`,pt=`mutation($input: UploadPlayerImageInput!) {\n    result: UploadPlayerImage(input: $input) { ${(0,k.M)(ut)} }\n}`;class vt{constructor(e){ct.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,ct,e,"f")}fetch({playerId:e,limit:t,offset:n,tags:i}){return lt(this,ct,"f").fetch(ft,{playerId:e,limit:t,offset:n,tags:i})}upload({file:e,tags:t,accessPayload:n}){return lt(this,ct,"f").fetch(pt,{file:e,tags:t,accessPayload:n})}}ct=new WeakMap;const gt=2048,yt=/cdn.eponesh.com\/static(\/([\d\-]+.)([\d\-]+.)|)\/(.*)/,mt=/-(\d+)x(\d+)\.\w+$/;var wt,bt,_t,Pt,Et,kt,St,Ct=function(e,t,n,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},xt=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},Tt=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},It=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const Ot="empty_url",At="empty_content",jt="empty_filename";class $t{constructor(){wt.set(this,{}),bt.set(this,void 0),_t.set(this,{}),Pt.set(this,(function(e,t){var{url:n,filename:i}=e,r=It(e,["url","filename"]);return xt(this,void 0,void 0,(function*(){if(!n)throw u.kg.error(Ot),new Error(Ot);if(!i)throw u.kg.error(jt),new Error(jt);if(Tt(this,_t,"f")[n]){const e=new File([Tt(this,_t,"f")[n]],i,Tt(this,_t,"f")[n]);return t(Object.assign(Object.assign({},r),{file:e}))}try{const e=yield fetch(n).then((e=>e.blob()));return t(Object.assign(Object.assign({},r),{file:new File([e],i,{type:e.type})}))}catch(e){throw u.kg.error(e),e}}))})),Et.set(this,(function(e,t){return xt(this,void 0,void 0,(function*(){const{content:n,filename:i}=e,r=It(e,["content","filename"]);if(!n.trim())throw u.kg.error(At),new Error(At);if(!i)throw u.kg.error(jt),new Error(jt);return t(Object.assign(Object.assign({},r),{file:new File([n],i)}))}))})),kt.set(this,(function(e={},t){return xt(this,void 0,void 0,(function*(){const n=(0,r._)();e.limit=e.limit||10;try{const i=yield t(e),r=i.length===e.limit;Tt(this,wt,"f")[Lt(e)]=Object.assign(Object.assign({},e),{canLoadMore:r}),n.done({items:i,canLoadMore:r})}catch(e){n.abort(e)}return n.ready}))})),St.set(this,(function(e={},t){return xt(this,void 0,void 0,(function*(){const n=Lt(e),i=Tt(this,wt,"f")[n];if(!i)return this.fetch(e,t);if(!i.canLoadMore)return{items:[],canLoadMore:!1};const s=(0,r._)(),o=(i.offset||0)+(i.limit||0);i.limit=e.limit||i.limit;const a=Object.assign({},Tt(this,wt,"f")[n]),c=Object.assign(Object.assign({},i),{offset:o});Tt(this,wt,"f")[n]=c;try{const e=yield t(c),i=e.length===c.limit;Tt(this,wt,"f")[n].canLoadMore=i,s.done({items:e,canLoadMore:i})}catch(e){Tt(this,wt,"f")[n]=a,s.abort(e)}return s.ready}))}));const{openFile:e}=function(){let e=null;const t=document.createElement("input");t.type="file",t.id="gs-file-input",t.style.cssText="position: fixed; top: -999px; left: -999px; z-index: 0;",t.onchange=e=>i(e.target),t.tabIndex=-1,document.body.appendChild(t);const n=()=>{setTimeout((()=>e.done(null)),1e3),document.body.removeEventListener("focus",n,!0)},i=t=>{const[i]=t.files?Array.from(t.files):[];document.body.removeEventListener("focus",n,!0),e.done(i)};return{input:t,openFile:(i="*")=>{return s=this,o=void 0,c=function*(){null==e||e.abort(),e=(0,r._)(),t.accept=i,t.click(),document.body.addEventListener("focus",n,!0);const s=yield e.ready;if(s)return s;throw new Error("cancelled")},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function i(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(n,i)}r((c=c.apply(s,o||[])).next())}));var s,o,a,c}}}();!function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,bt,e,"f")}chooseFile(e){return xt(this,void 0,void 0,(function*(){const t=(0,r._)();try{const n=yield Tt(this,bt,"f").call(this,e),i=URL.createObjectURL(n);Tt(this,_t,"f")[i]=n,t.done({file:n,tempUrl:i})}catch(e){t.abort(e)}return t.ready}))}upload(e,t){return xt(this,void 0,void 0,(function*(){const n=(0,r._)();try{e.file||(e.file=yield Tt(this,bt,"f").call(this,e.accept));const i=yield t(e);n.done(i)}catch(e){n.abort(e)}return n.ready}))}uploadUrl(e,t){return xt(this,void 0,void 0,(function*(){return Tt(this,Pt,"f").call(this,e,t)}))}uploadContent(e,t){return xt(this,void 0,void 0,(function*(){return Tt(this,Et,"f").call(this,e,t)}))}fetch(e={},t){return xt(this,void 0,void 0,(function*(){return Tt(this,kt,"f").call(this,e,t)}))}fetchMore(e={},t){return xt(this,void 0,void 0,(function*(){return Tt(this,St,"f").call(this,e,t)}))}}function Lt(e){return`p${e.playerId||0}:${(e.tags||[]).join(",")}`}wt=new WeakMap,bt=new WeakMap,_t=new WeakMap,Pt=new WeakMap,Et=new WeakMap,kt=new WeakMap,St=new WeakMap,Ct([E(300)],$t.prototype,"uploadUrl",null),Ct([E(300)],$t.prototype,"uploadContent",null),Ct([E(300)],$t.prototype,"fetch",null),Ct([E(300)],$t.prototype,"fetchMore",null);var Mt,Rt=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},Ft=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const Nt="image/png,.jpeg,.jpg";class Dt extends m.Z{constructor(e,t){super(),this.gs=e,this.acl=t,Mt.set(this,new $t)}get canUpload(){return this.acl.canUploadImages}resize(e,t,n,i){return function(e,t,n,i){const r=yt.exec(e);if(!r)return e;const[s,o]=function(e){const t=mt.exec(e);return t?[Number(t[1])||0,Number(t[2])||0]:[0,0]}(e);return s&&t>s&&(t=s),o&&n>o&&(n=o),t>gt&&(t=gt),n>gt&&(n=gt),`https://cdn.eponesh.com/static/${t||"-"}x${n||"-"}${i?"crop":""}/${r[4]}`}(e,t,n,i)}chooseFile(){return Rt(this,void 0,void 0,(function*(){const e=Ft(this,Mt,"f").chooseFile(Nt);return e.then((e=>this._events.emit("choose",e))),e.catch((e=>this._events.emit("error:choose",e))),e}))}upload(e={}){const t=Ft(this,Mt,"f").upload(Object.assign(Object.assign({},e),{accept:Nt}),(e=>Rt(this,void 0,void 0,(function*(){const t=yield this.gs.platform.requestPermissions({allowUploadImages:!0});if(!t.success)throw new Error("permission_not_allowed_by_user");return this.gs._imagesService.upload(Object.assign(Object.assign({},e),{accessPayload:t.payload}))}))));return this.gs.loader.inc(),t.then((e=>this._events.emit("upload",e))),t.catch((e=>this._events.emit("error:upload",e))),t.finally((()=>this.gs.loader.dec())),t}uploadUrl(e={url:""}){return Rt(this,void 0,void 0,(function*(){return Ft(this,Mt,"f").uploadUrl(Object.assign(Object.assign({},e),{filename:"image"}),(e=>this.upload(e)))}))}fetch(e={}){return Rt(this,void 0,void 0,(function*(){const t=Ft(this,Mt,"f").fetch(e,(e=>this.gs._imagesService.fetch(e).then((e=>e.items))));return this.gs.loader.inc(),t.then((e=>this._events.emit("fetch",e))),t.catch((e=>this._events.emit("error:fetch",e))),t.finally((()=>this.gs.loader.dec())),t}))}fetchMore(e={}){return Rt(this,void 0,void 0,(function*(){const t=Ft(this,Mt,"f").fetchMore(e,(e=>this.gs._imagesService.fetch(e).then((e=>e.items))));return this.gs.loader.inc(),t.then((e=>this._events.emit("fetchMore",e))),t.catch((e=>this._events.emit("error:fetchMore",e))),t.finally((()=>this.gs.loader.dec())),t}))}}Mt=new WeakMap;var Bt,Ut=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const Wt="\n    id: _id\n    playerId\n    src\n    size\n    name\n    tags\n",zt=`\n    ... on FilesList {\n        items { ${Wt} }\n    }\n`,Zt=`\n    ... on File { ${Wt} }\n`,qt=`query($input: FetchPlayerFilesInput!) {\n    result: FetchPlayerFiles(input: $input) { ${(0,k.M)(zt)} }\n}`,Gt=`mutation($input: UploadPlayerFileInput!) {\n    result: UploadPlayerFile(input: $input) { ${(0,k.M)(Zt)} }\n}`;class Kt{constructor(e){Bt.set(this,void 0),function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,Bt,e,"f")}fetch({playerId:e,limit:t,offset:n,tags:i}){return Ut(this,Bt,"f").fetch(qt,{playerId:e,limit:t,offset:n,tags:i})}upload({file:e,tags:t}){return Ut(this,Bt,"f").fetch(Gt,{file:e,tags:t})}}Bt=new WeakMap;var Jt,Vt=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},Yt=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class Ht extends m.Z{constructor(e,t){super(),this.gs=e,this.acl=t,Jt.set(this,new $t)}get canUpload(){return this.acl.canUploadFiles}chooseFile(e){return Vt(this,void 0,void 0,(function*(){const t=Yt(this,Jt,"f").chooseFile(e);return t.then((e=>this._events.emit("choose",e))),t.catch((e=>this._events.emit("error:choose",e))),t}))}upload(e){return Vt(this,void 0,void 0,(function*(){const t=Yt(this,Jt,"f").upload(e,(e=>this.gs._filesService.upload(e)));return this.gs.loader.inc(),t.then((e=>this._events.emit("upload",e))),t.catch((e=>this._events.emit("error:upload",e))),t.finally((()=>this.gs.loader.dec())),t}))}uploadContent(e){return Vt(this,void 0,void 0,(function*(){return Yt(this,Jt,"f").uploadContent(e,(e=>this.upload(e)))}))}uploadUrl(e){return Vt(this,void 0,void 0,(function*(){return Yt(this,Jt,"f").uploadUrl(e,(e=>this.upload(e)))}))}loadContent(e){return Vt(this,void 0,void 0,(function*(){const t=fetch(new URL(e).toString()).then((e=>e.text()));return this.gs.loader.inc(),t.then((e=>this._events.emit("loadContent",e))),t.catch((e=>this._events.emit("error:loadContent",e))),t.finally((()=>this.gs.loader.dec())),t}))}fetch(e={}){return Vt(this,void 0,void 0,(function*(){const t=Yt(this,Jt,"f").fetch(e,(e=>this.gs._filesService.fetch(e).then((e=>e.items))));return this.gs.loader.inc(),t.then((e=>this._events.emit("fetch",e))),t.catch((e=>this._events.emit("error:fetch",e))),t.finally((()=>this.gs.loader.dec())),t}))}fetchMore(e={}){return Vt(this,void 0,void 0,(function*(){const t=Yt(this,Jt,"f").fetchMore(e,(e=>this.gs._filesService.fetch(e).then((e=>e.items))));return this.gs.loader.inc(),t.then((e=>this._events.emit("fetchMore",e))),t.catch((e=>this._events.emit("error:fetchMore",e))),t.finally((()=>this.gs.loader.dec())),t}))}}Jt=new WeakMap;var Xt=o(1049);class Qt extends m.Z{constructor(e){super(),this.gs=e}fetch({ids:e}){return t=this,n=void 0,s=function*(){const t=(0,r._)();return this.gs.loader.inc(),t.ready.then((e=>this._events.emit("fetch",e))).catch((e=>this._events.emit("fetch:error",e))),this.gs._playerService.fetchPlayers({ids:e}).then(t.done).catch(t.abort).finally((()=>this.gs.loader.dec())),t.ready},new((i=void 0)||(i=Promise))((function(e,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}c((s=s.apply(t,n||[])).next())}));var t,n,i,s}}let en;try{new EventTarget,en=!0}catch(e){en=!1}var tn=en?EventTarget:class{constructor(){this.e={}}addEventListener(e,t,n=!1){this.t(e).push(t)}removeEventListener(e,t,n=!1){const i=this.t(e),r=i.indexOf(t);r>-1&&i.splice(r,1)}dispatchEvent(e){return e.target=this,Object.freeze(e),this.t(e.type).forEach((t=>t(e))),!0}t(e){return this.e[e]=this.e[e]||[]}},nn=en?Event:class{constructor(e){this.type=e}};class rn extends nn{constructor(e,t){super(e),this.newState=t.newState,this.oldState=t.oldState,this.originalEvent=t.originalEvent}}const sn="active",on="passive",an="hidden",cn="frozen",ln="terminated",hn="object"==typeof safari&&safari.pushNotification,dn=["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in self?"pagehide":"unload"],un=e=>(e.preventDefault(),e.returnValue="Are you sure?"),fn=[[sn,on,an,ln],[sn,on,an,cn],[an,on,sn],[cn,an],[cn,sn],[cn,on]].map((e=>e.reduce(((e,t,n)=>(e[t]=n,e)),{}))),pn=()=>document.visibilityState===an?an:document.hasFocus()?sn:on,vn=new class extends tn{constructor(){super();const e=pn();this.s=e,this.i=[],this.a=this.a.bind(this),dn.forEach((e=>addEventListener(e,this.a,!0))),hn&&addEventListener("beforeunload",(e=>{this.n=setTimeout((()=>{e.defaultPrevented||e.returnValue.length>0||this.r(e,an)}),0)}))}get state(){return this.s}get pageWasDiscarded(){return document.wasDiscarded||!1}addUnsavedChanges(e){!this.i.indexOf(e)>-1&&(0===this.i.length&&addEventListener("beforeunload",un),this.i.push(e))}removeUnsavedChanges(e){const t=this.i.indexOf(e);t>-1&&(this.i.splice(t,1),0===this.i.length&&removeEventListener("beforeunload",un))}r(e,t){if(t!==this.s){const n=((e,t)=>{for(let n,i=0;n=fn[i];++i){const i=n[e],r=n[t];if(i>=0&&r>=0&&r>i)return Object.keys(n).slice(i,r+1)}return[]})(this.s,t);for(let t=0;t<n.length-1;++t){const i=n[t],r=n[t+1];this.s=r,this.dispatchEvent(new rn("statechange",{oldState:i,newState:r,originalEvent:e}))}}}a(e){switch(hn&&clearTimeout(this.n),e.type){case"pageshow":case"resume":this.r(e,pn());break;case"focus":this.r(e,sn);break;case"blur":this.s===sn&&this.r(e,pn());break;case"pagehide":case"unload":this.r(e,e.persisted?cn:ln);break;case"visibilitychange":this.s!==cn&&this.s!==ln&&this.r(e,pn());break;case"freeze":this.r(e,cn)}}},gn=["hidden","frozen","terminated"];function yn({url:e,blur:t=0,fade:n=0}){e?(function(e){document.querySelectorAll(".gs-custom-background").forEach((t=>{t.childNodes.forEach((e=>{e.style.opacity="0"})),setTimeout((()=>{t.remove()}),1e3*e)}))}(n),function(e){const t=document.createElement("div");document.body.style.setProperty("background","transparent","important"),t.classList.add("gs-custom-background"),function(e,t){const n=document.createElement("div");n.style.cssText=`\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        z-index: -1;\n        background: transparent;\n        backdrop-filter: blur(${e.blur}px);\n        \n        transition: ${e.fade}s;\n    `,n.classList.add("gs-custom-background-blur"),t.append(n)}(e,t),function(e,t){const n=document.createElement("div");n.style.cssText=`\n        background-image: url(${e.url});\n        background-size: cover;\n        background-repeat: no-repeat;\n        background-position: center;\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        z-index: -2;\n        opacity: 0;\n        transition: ${e.fade}s;\n    `,n.classList.add("gs-custom-background-img"),t.append(n),setTimeout((()=>{n.style.opacity="1"}),100)}(e,t),document.body.append(t)}({url:e,blur:t,fade:n})):u.kg.warn("Empty background url")}var mn,wn,bn,_n=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},Pn=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},En=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class kn extends m.Z{constructor(){super(),this.setBackground=yn,this.loader=function(){let e=0;const t=document.createElement("div");function n(){t.style.display=e>0?"flex":"none"}return t.classList.add("gs-global-loader"),t.innerHTML='<div class="gs-loader">\n        <div class="gs-loader__outter"></div>\n        <div class="gs-loader__inner"></div>\n    </div>',document.body.appendChild(t),{inc(){e+=1,n()},dec(){e=e<=0?0:e-1,n()}}}(),this.isPaused=!1,mn.set(this,void 0),wn.set(this,void 0),bn.set(this,void 0);const e=(0,r._)();this.ready=e.ready;const c=new URL(document.currentScript.src).searchParams,l=Number(c.get("projectId")),h=c.get("publicToken"),d=c.get("callback")||"onGSInit";this.ready.then((e=>{var t,n;return null===(n=(t=window)[d])||void 0===n?void 0:n.call(t,e)})),this.fullscreen=new W,this.analytics=new z,this.leaderboard=new x(this),this.achievements=new ce(this),this.gamesCollections=new Ue(this),this.documents=new it(this),this.players=new Qt(this),this.isMobile=t()({tablet:!0,featureDetect:!0});const p=navigator.language.slice(0,2).toLowerCase(),v=Object.values(f.Uo).includes(p)?p:null,g=function(){const e=new URL(window.location.href),{searchParams:t,hostname:n}=e;return t.has("_platform")?t.get("_platform"):function(e){return!!e.hostname.includes("games.s3.yandex.net")||!!e.hash.includes("origin=https")&&(e.hash.includes("app-id=")||e.searchParams.has("app-id"))}(e)?i.z.YANDEX:n.includes("gamemonetize.co")?i.z.GAME_MONETIZE:n.includes("gamedistribution.co")?i.z.GAME_DISTRIBUTION:n.includes("crazygames.com")?i.z.CRAZY_GAMES:n.includes(".gamepix.com")?i.z.GAMEPIX:t.has("api_id")&&t.has("viewer_id")&&t.has("auth_key")||t.get("vk_user_id")&&t.get("sign")&&t.get("vk_app_id")?i.z.VK:t.has("auth_sig")&&t.has("session_key")?i.z.OK:n.includes("static.developer.sberdevices.ru")||Array.isArray(window.appInitialData)&&window.appInitialData.some((e=>"app_context"===(null==e?void 0:e.type)))?i.z.SMARTMARKET:i.z.NONE}();Pn(this,wn,new $e("https://api.eponesh.com/gs/api/graphql",l,h,v||f.Uo.EN,g),"f");const m=e=>{En(this,wn,"f").setPlayerData(e)};var w,b;this._playerService=new s.Z(En(this,wn,"f")),this._leaderboardsService=new Qe(En(this,wn,"f")),this._projectService=new f.ZP(En(this,wn,"f")),this._achievementsService=new Q.ZP(En(this,wn,"f")),this._paymentsService=new Se(En(this,wn,"f")),this._gamesCollectionsService=new Re(En(this,wn,"f")),this._documentsService=new tt(En(this,wn,"f")),this._imagesService=new vt(En(this,wn,"f")),this._filesService=new Kt(En(this,wn,"f")),function({platformType:e,tools:t}){return function(e,t){switch(e){case i.z.YANDEX:return o.e(755).then(o.bind(o,838)).then((e=>e.default(t)));case i.z.VK:return o.e(911).then(o.bind(o,1440)).then((e=>e.default(t)));case i.z.OK:return o.e(614).then(o.bind(o,1069)).then((e=>e.default(t)));case i.z.GAME_MONETIZE:return o.e(369).then(o.bind(o,3978)).then((e=>e.default(t)));case i.z.GAMEPIX:return o.e(477).then(o.bind(o,5940)).then((e=>e.default(t)));case i.z.GAME_DISTRIBUTION:return o.e(860).then(o.bind(o,3102)).then((e=>e.default(t)));case i.z.CRAZY_GAMES:return o.e(433).then(o.bind(o,1229)).then((e=>e.default(t)));case i.z.SMARTMARKET:return o.e(552).then(o.bind(o,3689)).then((e=>e.default(t)));case i.z.NONE:default:return o.e(766).then(o.bind(o,4555)).then((e=>e.default(t)))}}(e,t)}({platformType:g,tools:{gs:this,setupStorage:e=>{const t=[new ue(l),...e];try{null!==window.localStorage&&t.push(new ge(l))}catch(e){}return this._storage=new y(t),this._storage.ready},fetchConfig:e=>_n(this,void 0,void 0,(function*(){yield this._storage.ready;const[t,n]=yield Promise.all([this._storage.loadLanguage(),this._storage.loadConfig(),this._storage.loadAdsInfo()]);return t||this._storage.saveLanguage(null),this.language=t||e||v||f.Uo.EN,En(this,wn,"f").setLang(this.language),this._projectService.fetchConfig().then((e=>e||n)).catch((e=>(console.error(e),n)))}))}}).then((t=>_n(this,void 0,void 0,(function*(){const{adsAdapter:r,playerAdapter:s,platformAdapter:c,socialsAdapter:l,paymentsAdapter:h,projectConfig:d,appAdapter:f}=t;Pn(this,mn,d,"f"),g!==i.z.GAMEPIX&&(d.config.ymCounterId&&this.analytics.addCounter(new G({counterId:d.config.ymCounterId})),d.config.gtagCounterId&&this.analytics.addCounter(new V({counterId:d.config.gtagCounterId}))),this.avatarGenerator=d.config.avatarGenerator,this.avatarGeneratorTemplate=d.config.avatarGeneratorTemplate,this._storage.saveConfig(d),this.platform=new a(d.platformConfig,c),this.ads=new n.Z(this,r,d.platformConfig),this.app=new X(this,f,d),this.socials=new H(l,this),this.player=new U({},d.playerFields,s,this,m),this.payments=new Ie.Z(this,h),this.variables=new at(this,d.gameVariables||[]),this.images=new Dt(this,d.acl),this.files=new Ht(this,d.acl),Pn(this,bn,Date.parse(d.serverTime),"f"),setInterval((()=>Pn(this,bn,En(this,bn,"f")+1e3,"f")),1e3),this.isDev?(this.devtools=yield Promise.all([o.e(690),o.e(9),o.e(600)]).then(o.bind(o,5169)).then((e=>e.default(this,d))),En(this,wn,"f").addCounterListener((e=>{this.devtools.showCounter(e)}))):u.kg.stopCollect(),this.init(e)})))).catch(u.kg.error),w=()=>this.pause(),b=()=>this.resume(),vn.addEventListener("statechange",(e=>{gn.includes(e.newState)?w():b()}))}get nativeSDK(){return this.platform.getNativeSDK()}get serverTime(){return new Date(En(this,bn,"f")).toISOString()}get isDev(){var e;return(null===(e=En(this,mn,"f"))||void 0===e?void 0:e.isDev)||!1}get isAllowedOrigin(){var e;return(null===(e=En(this,mn,"f"))||void 0===e?void 0:e.isAllowedOrigin)||!1}init(e){return _n(this,void 0,void 0,(function*(){this.ads.on("fullscreen:start",(()=>this.pause())),this.ads.on("fullscreen:close",(()=>this.resume())),this.ads.on("preloader:start",(()=>this.pause())),this.ads.on("preloader:close",(()=>this.resume())),this.ads.on("rewarded:start",(()=>this.pause())),this.ads.on("rewarded:close",(()=>this.resume())),yield Promise.all([this.ads.checkAdblock()]).catch(u.kg.warn),e.done(this)}))}loadOverlay(){return _n(this,void 0,void 0,(function*(){this.overlay||(this.overlay=yield Promise.all([o.e(690),o.e(9),o.e(263)]).then(o.bind(o,8941)).then((e=>e.default(this))),this._events.emit("overlay:ready"))}))}changeLanguage(e){return _n(this,void 0,void 0,(function*(){if(this.language!==e)try{if(!Object.values(f.Uo).includes(e))throw new Error(`Language ${e} not supported`);this.language=e,this._storage.saveLanguage(e),this.overlay&&(yield this.overlay.changeLanguage(e)),En(this,wn,"f").setLang(this.language),this._events.emit("change:language",this.language)}catch(e){u.kg.error(e)}}))}changeAvatarGenerator(){return _n(this,void 0,void 0,(function*(){u.kg.warn("[DEPRECATED]: changeAvatarGenerator")}))}generateAvatar(e,t){return(0,Xt.Z)(this.avatarGeneratorTemplate,e,t)}pause(){this.isPaused||(this.isPaused=!0,this._events.emit("pause"))}resume(){this.isPaused&&(this.isPaused=!1,this._events.emit("resume"))}}mn=new WeakMap,wn=new WeakMap,bn=new WeakMap,new kn})()})();